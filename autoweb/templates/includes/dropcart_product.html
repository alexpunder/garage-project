{% load static %}

{% for cart_item in cart_products %}
<div class="dropcart__product">
    <div class="product-image dropcart__product-image">
        {% with cart_item.product.images.first as first_image %}
            {% if first_image %}
                <div class="product-card__image product-image">
                    <a href="{{ cart_item.product.get_absolute_url }}" class="product-image__body">
                    <img class="product-image__img img-fluid" src="{{ first_image.image.url }}">
                    </a>
                </div>
            {% else %}
                <a href="{{ cart_item.product.get_absolute_url }}" class="product-image__body">
                    <img class="product-image__img" src="{% static 'images/image-holder.webp' %}">
                </a>
            {% endif %}
        {% endwith %}
    </div>
    <div class="dropcart__product-info">
        <div class="dropcart__product-name"><a href="{{ cart_item.product.get_absolute_url }}">{{ cart_item.product.title }}</a></div>
        <ul class="dropcart__product-options">
            <li>{{ cart_item.product.subcategory }}</li>
            <li>{{ cart_item.product.brand }}</li>
            <li>{{ cart_item.product.article }}</li>
        </ul>
        <div class="dropcart__product-meta">
            <span class="dropcart__product-quantity">{{ cart_item.quantity }}</span> ×
            <span class="dropcart__product-price">{{ cart_item.product.price }} руб.</span>
        </div>
    </div>
    <form method="POST" action="{% url 'cart:cart_delete' cart_item.product.pk %}" style="display: inline;">
        {% csrf_token %}
        <button type="submit" class="btn btn-light btn-sm btn-svg-icon" aria-label="Удалить из корзины"
            hx-post="{% url 'cart:cart_delete' cart_item.product.pk %}"
            hx-target="body"
        >
            <svg width="12px" height="12px">
                <use xlink:href="/static/images/sprite.svg#cross-12"></use>
            </svg>
        </button>
    </form>
</div>
{% endfor %}
